# Neataptic 神經網路套件

[Neataptic]:https://github.com/wagenaartje/neataptic
[xorEx.js]:xorEx.js
[hopfieldEx.js]:hopfieldEx.js
[lstmEx.js]:lstmEx.js
[narxEx.js]:narxEx.js

[Neataptic] 是 [wagenaartje](https://github.com/wagenaartje) 用 JavaScript 撰寫的神經網路 (Neural Network) 套件，主要是把感知器的反傳遞網路 Backpropagation 加上遺傳演化算法結合在一起。

但是如果我們暫時撇開《遺傳演化算法》不談，[Neataptic] 其實可以很好的完成《感知器 + Hopfield 容錯記憶網路 + LSTM 遞歸神經網路》的任務。

以下是我們用來示範 Neataptic 功能的一些範例程式。

範例     | 程式 | 說明 
--------|-----|--------------------------------
XOR 感知器 | [xorEx.js] | XOR 用單層神經網路無法完成，因此是測試多層網路的最基本範例。
容錯記憶網路 | [hopfieldEx.js] | 記住後，稍有錯誤還是可以提取回來。
LSTM 網路 | [lstmEx.js] | 遞歸網路 RNN 的延伸，長短期記憶模型，本範例用來學習 000100010001... 的固定樣式序列。
NARX 網路 | [lstmEx.js] | [NARX](https://en.wikipedia.org/wiki/Nonlinear_autoregressive_exogenous_model) 網路，本範例還是用來學習 000100010001... 的固定樣式序列。

## 安裝方法

```
$ git clone https://github.com/ccckmit/ai6.git
$ cd ai6
$ npm install
$ cd book/nn/neataptic
```

然後你就可以開始執行下列範例了！

## 範例 : XOR 感知器

程式： [xorEx.js]

執行結果：

```
$ node xorEx

D:\Dropbox\github\ai6\book\nn\neataptic>node xorEx.js
[0, 0] => 0.1759039948193444
[0, 1] => 0.7190650459800166
[1, 0] => 0.8936360743294697
[1, 1] => 0.1589678929606128
```

## 範例 : Hopfield 容錯記憶網路

程式： [hopfieldEx.js]

執行結果：

```
$ node classified2d
0: avloss = 0.6926390656268775
1: avloss = 0.6079319150639381
2: avloss = 0.544738413662955
3: avloss = 0.4960600790068934
4: avloss = 0.4568650617104245
5: avloss = 0.4239681925366754
6: avloss = 0.3954026492236949
7: avloss = 0.36991470239945023
8: avloss = 0.34665083097033145
...
96: avloss = 0.016158735032651795
97: avloss = 0.015959671235881746
98: avloss = 0.015765543569039663
99: avloss = 0.015576178731016032
x=-0.4326 y=1.1909 label=1 w0=0.0043 w1=0.9957
x=3.0000 y=4 label=1 w0=0.0188 w1=0.9812
x=0.1253 y=-0.0376 label=1 w0=0.0084 w1=0.9916
x=0.2877 y=0.3273 label=1 w0=0.0139 w1=0.9861
x=-1.1465 y=0.1746 label=1 w0=0.0024 w1=0.9976
x=1.8133 y=1.0139 label=0 w0=0.9782 w1=0.0218
x=2.7258 y=1.0668 label=0 w0=0.9880 w1=0.0120
x=1.4117 y=0.5593 label=0 w0=0.9703 w1=0.0297
x=4.1832 y=0.3044 label=0 w0=0.9892 w1=0.0108
x=1.8636 y=0.1677 label=0 w0=0.9837 w1=0.0163
x=0.5000 y=3.2 label=1 w0=0.0090 w1=0.9910
x=0.8000 y=3.2 label=1 w0=0.0092 w1=0.9908
x=1.0000 y=-2.2 label=1 w0=0.0297 w1=0.9703
```

## 範例 : 數字辨識

程式： [mnistPredict.js]

執行結果：

```
D:\Dropbox\github\ai6\book\nn\convnetjs>node mnistPredict mnist/3.png
prob = {"sx":1,"sy":1,"depth":10,"w":{"0":0.000010923343930336934,"1":6.92728679933889e-8,"2
":0.0023810993989678117,"3":0.9745521665891758,"4":1.8340081483249712e-7,"5":0.0230457305123
80742,"6":0.0000034610106813664274,"7":0.0000018766610333963584,"8":0.0000033616660795228394
,"9":0.0000011281440682443508}}
yhat=3 class=3

D:\Dropbox\github\ai6\book\nn\convnetjs>node mnistPredict mnist/2.png
prob = {"sx":1,"sy":1,"depth":10,"w":{"0":0.0010535738445952624,"1":1.1990893606721855e-8,"2
":0.00027351140341995086,"3":0.0006070421170483321,"4":0.000001476107822754898,"5":0.0625423
5834857638,"6":1.5880431439373823e-7,"7":0.9342859563103688,"8":0.0006515079930608026,"9":0.
0005844030798995669}}
yhat=7 class=7

D:\Dropbox\github\ai6\book\nn\convnetjs>node mnistPredict mnist/5.png
prob = {"sx":1,"sy":1,"depth":10,"w":{"0":0.009062010637839395,"1":0.000020162466540627157,"
2":0.0104861679391416,"3":0.009956732504541047,"4":0.000006336915105310351,"5":0.96803134024
76854,"6":0.0004724523803393561,"7":0.0016217035681368212,"8":0.00026114428908309627,"9":0.0
0008194905158701984}}
yhat=5 class=5

D:\Dropbox\github\ai6\book\nn\convnetjs>node mnistPredict mnist/4.png
prob = {"sx":1,"sy":1,"depth":10,"w":{"0":0.028692523186077575,"1":5.02205736407436e-9,"2":0
.07484723060778124,"3":0.00006464052188511926,"4":0.7821497035942716,"5":0.00270130829780131
2,"6":0.11140825235536667,"7":0.00000276406585927267,"8":0.00008180864642785416,"9":0.000051
76370247194745}}
yhat=4 class=4
```


## 範例 : 影像辨識

程式： [cifar10predict.js]

執行結果：

```
D:\Dropbox\github\ai6\book\nn\convnetjs>node cifar10predict cifar10/horse1.png
prob = {"sx":1,"sy":1,"depth":10,"w":{"0":0.0016191668416885175,"1":0.000012028667443401294,
"2":0.00042730552373016205,"3":0.00945259560059607,"4":0.04008810208195672,"5":0.00353869245
13365046,"6":0.0000444488262784924,"7":0.9446988432571785,"8":0.00001403701234182708,"9":0.0
0010477973744988698}}
yhat=7 class=horse

D:\Dropbox\github\ai6\book\nn\convnetjs>node cifar10predict cifar10/cat1.png
prob = {"sx":1,"sy":1,"depth":10,"w":{"0":0.0003985102369045928,"1":3.437716650950919e-7,"2"
:0.011440874029435015,"3":0.6484472087027208,"4":0.11506053677703139,"5":0.19549242547893048
,"6":0.00012934290600129334,"7":0.028992669050050313,"8":0.00002642396533101553,"9":0.000011
665081930143968}}
yhat=3 class=cat

D:\Dropbox\github\ai6\book\nn\convnetjs>node cifar10predict cifar10/frog1.png
prob = {"sx":1,"sy":1,"depth":10,"w":{"0":0.00003421294931794948,"1":0.000017947038770644535
,"2":0.033605270574590874,"3":0.006853134039534868,"4":0.010987703276430564,"5":0.0033318320
674363988,"6":0.9449662927777916,"7":0.0001895019112482015,"8":0.0000019482396542533928,"9":
0.000012157125224625852}}
yhat=6 class=frog
```
